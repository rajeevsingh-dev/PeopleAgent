# PeopleAgent

PeopleAgent - Intelligent Microsoft 365 User Information Assistant
A GenAI-powered conversational Chat AI that combines Microsoft Graph API data with Azure OpenAI to provide natural language interactions about Microsoft 365 users.


## Core Architecture
The application operates in three main flows:

#### 1. Query Analysis (Azure OpenAI)

- Interprets natural language queries
- Determines required data categories (profile, manager, devices, etc.)
- Converts user intent into structured API requests

#### 2. Data Retrieval (Microsoft Graph API)

- Fetches user information using application permissions
- Supports multiple data endpoints:
- User profiles and basic information
- Organizational structure (managers/reports)
- Device inventory
- Document access
- Team collaborations

#### 3. Response Generation (Azure OpenAI)

- Processes raw API data through LLM
- Generates natural language responses
- Provides conversational context management

## Features

- Microsoft Graph API integration
- User information retrieval
- Delegated access - sample code
- Application-level - sample code
- PeopleAgent - to provide user information


## Project Structure (PeopleAgent folder)

```
PeopleAgent/
├── PeopleAgent/
│   ├── logs/
│   ├── parameters.json
│   └── PeopleAgent_v1.py
├── PeopleAgentv2/
│   
├── Samples/
│   ├── GetUserDetails-Application/
│   │   ├── GetAllUsers.py
│   │   └── parameters.json
│   └── GetUserDetails-Delegates/
│       └── GetUser.py
└── requirements.txt
```

## Prerequisites

- [Python 3.9 or higher](https://www.python.org/downloads/)

- [Microsoft Graph SDK](https://pypi.org/project/msgraph-sdk/) Use the Microsoft Graph SDK for Python

- [App Registration Guide](https://learn.microsoft.com/en-us/entra/identity-platform/scenario-daemon-app-registration) Register your application in Entra ID

- [Authentication Guide](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-daemon-app-call-api?pivots=workforce&tab=python-workforce&tabs=asp-dot-net-core-workforce%2Cnode-external) - Microsoft MSAL with client credentials flow

- [Graph API Documentation](https://learn.microsoft.com/en-us/graph/api/user-list?view=graph-rest-1.0&tabs=http) Access user data using Microsoft Graph API.

- [Azure OpenAI Service](https://azure.microsoft.com/en-us/products/ai-services/openai-service/) - For query analysis and response generation



## Setup

1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/PeopleAgent.git
   cd PeopleAgent
   ```

2. Create and activate a virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate     # Windows
   ```

3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

4. Configure parameters.json with your Entra ID credentials: 
   ```json
   {
    "authority": "https://login.microsoftonline.com/Enter_the_Tenant_Name_Here",
    "client_id": "your_client_id",
    "scope": [ "https://graph.microsoft.com/.default" ],
    "secret": "The secret generated by AAD during your confidential app registration",
    "endpoint": "https://graph.microsoft.com/v1.0/users",
    "AOAI_ENDPOINT": "your_aoai_endpoint",
    "AOAI_KEY": "your_aoai_key",
    "AOAI_DEPLOYMENT": "your_deployment_name"
    }
   ```

## Usage

After setting up your environment and configurations, you can:

1. Run the sample applications to test Graph API connectivity
2. Execute the PeopleAgent to interact with user data through natural language queries
3. Ask questions about users in your organization through the conversational interface

### PeopleAgent version details

This code is based on below feature implementations.





### PeopleAgent Implementation

#### PeopleAgent_v1.py
The original implementation that uses a sophisticated approach to provide an intelligent assistant for Microsoft 365 user information:

- Implements client credentials flow to authenticate with Microsoft Graph API
- Fetches comprehensive user details including profiles, roles, and relationships
- Processes natural language questions through Azure OpenAI
- Maintains conversation history for contextual understanding
- Formats responses in a user-friendly, conversational manner
- Handles various query types (find user, report structure, device information, etc.)

#### PeopleAgent_v2
The v2 implementation features a modular architecture that separates concerns for better maintainability, improved error handling, and enhanced performance when processing user queries about Microsoft 365 users.

> Refer for more details: [PeopleAgentv2/Readme.md](./PeopleAgentv2/Readme.md).

#### PeopleAgent_v3
This version introduces advanced memory management and streaming capabilities to maintain conversation context and deliver real-time responses. It builds on previous implementations by integrating persistent storage, context sharing, and enhanced logging to optimize conversational interactions.

> Refer for more details: [PeopleAgentv3/Readme.md](./PeopleAgentv3/Readme.md).


> **NOTE:** To refer all version details, navigate to [PeopleAgent_version_details.md](./PeopleAgent_version_details.md).

## Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Support

For support, please open an issue in the GitHub repository.


## Quick Links

[![Graph API](https://img.shields.io/badge/Graph%20API-Documentation-blue)](https://learn.microsoft.com/en-us/graph/api/overview)
[![Python SDK](https://img.shields.io/badge/Python-SDK-yellow)](https://github.com/microsoftgraph/msgraph-sdk-python)
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)